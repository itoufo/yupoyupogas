/**
 * デフォルトプロンプトテンプレート
 * これらのプロンプトはシートのB2, B3セルに初期配置され、ユーザーが自由に編集できます
 */

/**
 * STEP1: ストーリー設計用プロンプト
 * @param {string} theme - テーマ（A2セルの値）
 * @param {string} method - 占い手法（A3セルの値）
 * @returns {string} プロンプトテキスト
 */
function getStoryDesignPrompt(theme, method) {
  return `あなたは日本語の「占い師のプロ」として、信頼・安心・教育的なSNSストーリーを設計します。
シリーズテーマ：「${theme}」
占い手法は**「${method}」のみ**を使用します。他の手法名は出しません。

目的：
- 読者が「私も大丈夫かも」「占いを受けてみたい」と感じ、プロフィール欄から予約に進む。
- 親しみやすさと専門性で信頼を築く（煽り・断定過多なし）。

序盤の共感（重要）：
- 1〜2本目では、本文に「本当のあなた」「安心」「報われない」「頑張ってきた」などの共感ワードを必ず含める（見出しには入れない）。

教育設計（読者体験）：
1) 誤解の解像度を上げる導入（軽い未完）
2) 仕組み・原理の解説（好奇心ギャップ）
3) 活用・変化の橋渡し（小さな成功の想起）
4) 不安の解毒と安心設計（倫理・プロの姿勢）

出力（B2にそのまま貼る文章）：
ストーリー全体のテーマ：
- ${theme}（手法：${method}）

全体の狙い：
（読者に与える安心・気づき・行動の変化を一文で）

シリーズ構成（4〜5本で完結）：
1. 導入（誤解・気づき）／タイトル案／心理的狙い
2. 原理（理解）／タイトル案／心理的狙い
3. 体験（応用）／タイトル案／心理的狙い
4. 安心（信頼）／タイトル案／心理的狙い

最後に：
占い師としての信念と姿勢を一文で`;
}

/**
 * STEP2: 7分割投稿生成用プロンプト
 * @param {string} method - 占い手法（A3セルの値）
 * @param {string} storyText - STEP1で生成されたストーリー設計テキスト
 * @returns {string} プロンプトテキスト
 */
function getRowsGenerationPrompt(method, storyText) {
  return `あなたは日本語の「占い師のプロ」です。手法は**「${method}」のみ**使用してください。
以下の設計に基づき、4〜5本のストーリー投稿＋共通のInstagramキャプション1本を生成します。

【ストーリー設計】
${storyText}

■ 各ストーリー投稿の制約：
- **誠実・上品・穏やか。教えるのではなく「気づかせる」口調**
- 体験・観察・原理を自然に織り交ぜ、依存を生まない助言。プライバシー配慮。
- **見出し（title）は超重要！共感フレーズで読者を引き込む**：
  - 「本当のあなた」「安心」「報われない」「頑張ってきた」「大丈夫」「見えてる」「わかってる」「辛かった」「無理しないで」等を積極的に使用
  - 読者が「これ私のこと！」と思わず足を止める見出しにする
- **投稿1と2**では本文にも共感表現を必ず含む
- **文字数を厳守**：
  - title：12文字以内（共感フレーズ必須、目を引く表現）
  - l1a：10文字以内／l1b：10文字以内
  - l2a：10文字以内／l2b：10文字以内（※1文を途中で分割可）
  - l3a：15文字以内／l3b：15文字以内
- 絵文字・ハッシュタグ・URL・@メンション禁止

■ Instagramキャプション（全投稿共通で1本のみ）：
**文字数：400〜600文字** で、視聴者との深いつながりを作る内容にしてください。

【構成】
1. **冒頭の共感（2〜3行）**
   - 読者の悩みや状況に寄り添う言葉
   - 「最近、こんなふうに感じていませんか？」など、読者の心の声を代弁

2. **シリーズの紹介（3〜4行）**
   - このストーリーシリーズで伝えたい核心メッセージ
   - ${method}の視点から見た気づきや学び
   - 「このシリーズでは...」「${method}で見ると...」

3. **具体的な価値提供（4〜5行）**
   - このシリーズを見ることで得られる変化
   - 読者が「自分も変われるかも」と思える希望
   - 具体例や小さな実践アドバイス

4. **コメント誘導（2〜3行）**
   - 読者に質問を投げかける
   - 例：「あなたはこのシリーズのどの言葉が一番響きましたか？」
   - 例：「同じように感じた方、コメント欄で教えてください💬」
   - 例：「今の気持ちを一言で表すなら？✨」

5. **予約導線（2行）**
   - 「あなたの悩みに寄り添う個別相談も受け付けています」
   - 「無料相談はプロフィール欄をご覧ください。今だけ特別に無料！」

6. **ハッシュタグ（1〜2行）**
   - #占い #スピリチュアル #恋愛相談 #恋愛サポート #星流命理 #${method} #自己理解 #心の癒し など8〜12個

【トーン・書式】
- 優しく、温かく、読者の味方である姿勢
- 押し付けがましくなく、自然な流れで行動を促す
- 絵文字を適度に使用（💫✨🌙💝など、スピリチュアルな雰囲気）
- **改行は必須**：2〜3文ごとに改行を入れ、読みやすく
- 各セクション間は空行（\\n\\n）で区切る
- 長い文章の塊にならないよう、適度に段落分け

【改行の例】
最近、自分らしさがわからなくなっていませんか？
周りに合わせすぎて、本当の気持ちを見失っていませんか？💫

このシリーズでは、${method}の視点から...
（空行）
あなたが本来持っている輝きを...
（空行）
コメント欄で教えてください💬
（空行）
無料相談はプロフィール欄を...

出力（JSONのみ／説明・コードフェンス禁止）：
{
  "posts": [
    {
      "title": "",
      "l1a": "", "l1b": "",
      "l2a": "", "l2b": "",
      "l3a": "", "l3b": ""
    }
  ],
  "instagram_caption": "上記構成に従った400〜600文字のキャプション。冒頭の共感→シリーズ紹介→価値提供→コメント誘導→予約導線→ハッシュタグの順。改行を効果的に使い、絵文字も適度に含める。"
}
※posts配列は4〜5本で完結させてください。`;
}

/**
 * 12星座STEP1: サブテーマ生成用プロンプト
 * @param {string} theme - メインテーマ（A2セルの値、例：恋愛）
 * @returns {string} プロンプトテキスト
 */
function getZodiacThemesPrompt(theme) {
  return `あなたは日本語の「占い師のプロ」として、Instagram投稿用の12星座別コンテンツを設計します。

メインテーマ：「${theme}」

目的：
- 読者が自分の星座や気になる相手の星座をチェックしたくなる
- 保存・シェアしたくなる実用的で共感できる内容
- プロフィール欄から無料占いや予約につながる導線

タスク：
メインテーマ「${theme}」に関連する、魅力的なサブテーマを3〜5個生成してください。

サブテーマの条件：
- 12星座それぞれの特徴が際立つテーマ
- 読者が「当たってる！」「気になる！」と感じるもの
- 各星座15文字以内の短文で表現できるもの
- 具体的で想像しやすいもの

例（恋愛テーマの場合）：
1. 恋に落ちる相手
2. ドキッとする瞬間
3. 愛情表現の仕方
4. 長続きする関係のコツ

出力形式（そのままテキストで、番号付きリスト）：
1. [サブテーマ1]
2. [サブテーマ2]
3. [サブテーマ3]
（3〜5個）

※説明やコメントは不要。サブテーマのリストのみを出力してください。`;
}

/**
 * 12星座STEP2: 12星座別短文＋キャプション生成用プロンプト
 * @param {string} theme - メインテーマ（A2セルの値）
 * @param {string} subThemes - STEP1で生成されたサブテーマリスト
 * @returns {string} プロンプトテキスト
 */
function getZodiacContentsPrompt(theme, subThemes) {
  return `あなたは日本語の「占い師のプロ」です。12星座別のInstagram投稿コンテンツを生成します。

メインテーマ：「${theme}」

【サブテーマ一覧】
${subThemes}

タスク：
各サブテーマごとに、12星座別の短文を生成してください。

制約：
- 各星座の短文は**15文字以内**（簡潔で印象的に）
- 12星座の順序は必ず以下の通り：牡羊座、牡牛座、双子座、蟹座、獅子座、乙女座、天秤座、蠍座、射手座、山羊座、水瓶座、魚座
- 占い師らしい誠実で上品なトーン
- 各星座の性質を活かした内容
- 絵文字・ハッシュタグは使用しない（本文のみ）

出力形式（JSON）：
{
  "contents": [
    {
      "subtheme": "[サブテーマ1]",
      "zodiac_texts": {
        "牡羊座": "",
        "牡牛座": "",
        "双子座": "",
        "蟹座": "",
        "獅子座": "",
        "乙女座": "",
        "天秤座": "",
        "蠍座": "",
        "射手座": "",
        "山羊座": "",
        "水瓶座": "",
        "魚座": ""
      }
    }
  ],
  "instagram_caption": ""
}

Instagramキャプションの条件：
- 冒頭で読者に問いかけ（例：「あなたはどんな相手に恋に落ちやすいですか？」）
- 自分の星座や気になる相手の特徴もチェックするよう誘導
- フォローといいねで恋愛運上昇・引き寄せが始まる旨を記載
- 無料占い実施中（プロフィールのリンク・固定投稿から参加）を明記
- 星座の性質を知ることで恋愛・人間関係がスムーズになることを伝える
- 保存を促す一文
- 最後に感謝のメッセージ
- 区切り線（┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈）
- 自己紹介（最強のご縁を引き寄せる占い師、フォローで恋愛運急上昇など）
- ストーリーズで毎日タロット占い・開運メッセージ配信中
- ハッシュタグ：#占い #恋愛占い師 #恋愛運上昇 #性格診断 #引き寄せの法則 など
- 全体で親しみやすく、でも押し付けがましくないトーン

※コードフェンスや説明は不要。JSONのみを出力してください。`;
}

/**
 * ランキングSTEP1: ランキング設計用プロンプト
 * @param {string} theme - ランキングのテーマ（A2セルの値、例：2025年の恋愛運）
 * @param {string} type - 星座 or 誕生月（A3セルの値）
 * @returns {string} プロンプトテキスト
 */
function getRankingDesignPrompt(theme, type) {
  return `あなたは日本語の「占い師のプロ」として、Instagram投稿用のランキングコンテンツを設計します。

ランキングテーマ：「${theme}」
分類タイプ：${type}（${type === '星座' ? '12星座' : '12ヶ月'}）× 血液型（A、B、O、AB）

目的：
- 読者が自分の組み合わせや気になる人の順位をチェックしたくなる
- 保存・シェアしたくなる魅力的なランキング
- プロフィール欄から無料占いや予約につながる導線

タスク：
このランキングの全体コンセプトと順位付けの基準を設計してください。

設計内容：
1. ランキングの狙い・コンセプト（読者にどんな気づきや楽しさを与えるか）
2. 順位付けの基準（${type}の性質と血液型の特性をどう組み合わせて評価するか）
3. 上位になりやすい傾向（どんな組み合わせが高ランクになるか）
4. 下位でもポジティブに（全ての順位に価値がある理由）
5. 占い師としてのメッセージ

出力形式（そのままテキストで）：
【ランキングコンセプト】
（1〜2行で）

【順位付けの基準】
・基準1: ...
・基準2: ...
・基準3: ...

【上位の傾向】
（1〜2行で）

【順位に関わらず大切なこと】
（1〜2行で）

【占い師からのメッセージ】
（1〜2行で）

※説明やコメントは不要。上記フォーマットのテキストのみを出力してください。`;
}

/**
 * ランキングSTEP2: ランキング30生成用プロンプト
 * @param {string} theme - ランキングのテーマ（A2セルの値）
 * @param {string} type - 星座 or 誕生月（A3セルの値）
 * @param {string} designText - STEP1で生成されたランキング設計テキスト
 * @returns {string} プロンプトテキスト
 */
function getRankingContentsPrompt(theme, type, designText) {
  const combinations = type === '星座'
    ? '牡羊座、牡牛座、双子座、蟹座、獅子座、乙女座、天秤座、蠍座、射手座、山羊座、水瓶座、魚座'
    : '1月、2月、3月、4月、5月、6月、7月、8月、9月、10月、11月、12月';

  return `あなたは日本語の「占い師のプロ」です。ランキングコンテンツを生成します。

ランキングテーマ：「${theme}」
分類タイプ：${type} × 血液型

【ランキング設計】
${designText}

タスク：
上記の設計に基づき、1位から30位までのランキングを生成してください。

組み合わせの範囲：
- ${type}：${combinations}
- 血液型：A型、B型、O型、AB型
- 合計48通りの中から30位まで選出

制約：
- 各順位の説明は**30文字以内**（簡潔で印象的に）
- 占い師らしい誠実で上品なトーン
- ポジティブな表現（下位でも前向きに）
- 絵文字・ハッシュタグは使用しない（本文のみ）
- 同じ${type}や血液型が偏らないようバランスよく配置

出力形式（JSON）：
{
  "rankings": [
    {
      "rank": 1,
      "combination": "${type === '星座' ? '牡羊座×A型' : '1月×A型'}",
      "description": "30文字以内の説明文"
    },
    {
      "rank": 2,
      "combination": "${type === '星座' ? '双子座×O型' : '3月×O型'}",
      "description": "30文字以内の説明文"
    }
  ],
  "instagram_caption": ""
}

Instagramキャプションの条件：
- 冒頭でランキングテーマを紹介（例：「【${theme}ランキングTOP30】」）
- 自分の順位や気になる人の順位もチェックするよう誘導
- フォローといいねで運気上昇・引き寄せが始まる旨を記載
- 無料占い実施中（プロフィールのリンク・固定投稿から参加）を明記
- ランキングは参考程度に、自分らしさを大切にするメッセージ
- 保存を促す一文
- 最後に感謝のメッセージ
- 区切り線（┈┈┈┈┈┈┈┈┈┈┈┈┈┈┈）
- 自己紹介（最強のご縁を引き寄せる占い師、フォローで恋愛運急上昇など）
- ストーリーズで毎日タロット占い・開運メッセージ配信中
- ハッシュタグ：#占い #${theme} #ランキング #性格診断 #引き寄せの法則 など
- 全体で親しみやすく、でも押し付けがましくないトーン

※コードフェンスや説明は不要。JSONのみを出力してください。`;
}

/**
 * 今日の星座占い用のプロンプト
 * @param {string} date - 日付 (例: "2025年10月21日")
 * @return {string} 今日の星座占い用プロンプト
 */
function getTodayHoroscopePrompt(date) {
  return `あなたはプロの占い師です。${date}の星座占いを作成してください。

以下の条件に従ってJSON形式で出力してください：

1. 今日はどんな日か
   - スピリチュアルな観点から今日の全体的な運勢の概要
   - 今日のパワースポット（都道府県レベルまたは具体的な場所）

2. 12星座のランキング（1位〜12位）
   各星座について以下を含める：
   - 順位
   - 星座名
   - ラッキーカラー
   - ラッキーフード
   - ラッキーアクション
   - 恋愛運コメント（短文30文字程度）
   - 恋愛運コメント（長文60文字程度）
   - 総合運コメント（短文30文字程度）
   - 総合運コメント（長文60文字程度）

JSON形式：
{
  "today_overview": {
    "description": "今日はどんな日かのスピリチュアルな解説",
    "power_spot": "今日のパワースポット"
  },
  "rankings": [
    {
      "rank": 1,
      "zodiac": "おひつじ座",
      "lucky_color": "赤",
      "lucky_food": "トマト",
      "lucky_action": "朝日を浴びる",
      "love_short": "運命の出会いが訪れる予感",
      "love_long": "積極的に行動することで、素敵な出会いや関係の進展が期待できる一日です",
      "overall_short": "全てが好転する最高の一日",
      "overall_long": "仕事も人間関係も順調で、チャレンジしたことが良い結果につながる幸運日です"
    }
  ]
}

※コードフェンスや説明は不要。JSONのみを出力してください。`;
}

/**
 * タロット占い用のプロンプト
 * @param {Array} selectedCards - 選択されたカードの配列
 * @return {string} タロット占い用プロンプト
 */
function getTarotPrompt(selectedCards) {
  const cardsDescription = selectedCards.map((card, index) =>
    `${index + 1}枚目: ${card.name}（${card.position}）`
  ).join('\n');

  return `あなたはプロのタロット占い師です。以下の10枚のカードが引かれました。
各カードについて、深いスピリチュアルな洞察とメッセージを提供してください。

引かれたカード：
${cardsDescription}

タスク：
各カードの啓示（メッセージ）を生成してください。

制約：
- 各カードのメッセージは**80文字以内**（簡潔で印象的に）
- 占い師らしい誠実で上品なトーン
- 正位置と逆位置で異なる解釈を提供
- 読者の心に寄り添う温かいメッセージ
- 絵文字・ハッシュタグは使用しない（本文のみ）

出力形式（JSON）：
{
  "cards": [
    {
      "number": 1,
      "name": "愚者",
      "position": "正位置",
      "message": "新しい始まりへの一歩。恐れずに純粋な心で前進すれば、未知の可能性が開けます。"
    },
    {
      "number": 2,
      "name": "魔術師",
      "position": "逆位置",
      "message": "今は内なる力を蓄える時。焦らず、自分の才能を信じて準備を整えましょう。"
    }
  ]
}

※コードフェンスや説明は不要。JSONのみを出力してください。`;
}
